if(window.MgPop===undefined){window.MgPop=new function(){p_settings.domain=window.location.host;p_settings.removeTarget=false;p_settings.prevId=0;p_settings.prevTime=0;p_settings.width=p_settings.width?p_settings.width:0;p_settings.height=p_settings.height?p_settings.height:0;p_settings.QQ=p_settings.QQ?p_settings.QQ:0;p_settings.PC=p_settings.PC?p_settings.PC:0;this.userAgent=navigator.userAgent.toLowerCase();this.blocks=[];this.currentBlock=null;this.currentId=1;this.startId=1;this.pseudoTime=1;this.cascadeEvent=false;this.prepopunders=[];this.currentTargetUrl="";this.mainTransitLink="";this.popunders={1:p_settings};this.option=p_settings;this.testCookie=function(){if(!this.getCookie("QQ")){this.setCookie("QQ",MgPop.option.QQ,MgPop.option.domain,MgPop.option.time)}if(document.cookie=="")return false;else return true};this.setCookie=function(e,t,n,r,i){i=i!=null?i:true;if(MgPop.option.PC>0&&e=="__popunder1"&&i&&this.getCookie("QQ")>0){MgPop.option.PC=MgPop.option.PC-1;this.setCookie("QQ",parseInt(this.getCookie("QQ"))-1,MgPop.option.domain,MgPop.option.time)}else{var s=new Date;s.setTime(s.getTime());var o=new Date(s.getTime()+36e5*r);document.cookie=e+"="+encodeURIComponent(t)+";expires="+o.toGMTString()+";path=/"+";domain="+n}};this.getCookie=function(e){var t=document.cookie;var n=e+"=";var r=t.indexOf("; "+n);if(r==-1){r=t.indexOf(n);if(r!=0)return null}else r+=2;var i=t.indexOf(";",r);if(i==-1)i=t.length;return decodeURIComponent(t.substring(r+n.length,i))};this.checkQq=function(){if(this.getCookie("QQ")>0&&this.getCookie("__popunder1")){this.setCookie("QQ",parseInt(this.getCookie("QQ"))-1,MgPop.option.domain,MgPop.option.time);this.setCookie("__popunder1",null,MgPop.option.domain,-1,false)}};this.saywho=function(){var e=navigator.userAgent,t=navigator.appName,n,r=e.match(/(opera|chrome|safari|firefox|msie|trident)\/?\s*([\d\.]+)/i)||[];r=r[2]?[r[1],r[2]]:[t,navigator.appVersion,"-?"];if(r&&(n=e.match(/version\/([\.\d]+)/i))!=null){r[2]=n[1]}return r};this.fire=function(){var e=this.saywho()[0];var t=parseInt(this.saywho()[1]);if(e=="MSIE"||e=="Safari"){MgPop.openerMagic(false)}else if(e=="Chrome"&&t>=28){if(t>=30){MgPop.openerFull(document.body,"left")}else{MgPop.openerClicker(document.body,"left")}}else if(e=="Firefox"){MgPop.openerMagic(true)}else{window.MgPop.openerCrazy()}};this.checkPop=function(){var e=this.getCookie("__popunder"+MgPop.currentId);var t=new Date;if((parseInt(e)?parseInt(e):0)+MgPop.option.time*36e5<t.getTime()){if(MgPop.currentId=="T"){if(MgPop.currentTargetUrl.indexOf(MgPop.mainTransitLink)==-1)return false;else{MgPop.popunders["T"].url=MgPop.prepopunders[Math.round(Math.random())]}}this.setCookie("__popunder"+MgPop.currentId,t.getTime(),MgPop.option.domain,MgPop.option.time);return true}else return false};this.cookieWorker=function(){this.setCookie("MG_ID"+this.currentId,1,MgPop.option.domain,MgPop.option.time);if(this.checkPop()==true)return true;else{if(this.popunders["T"]){var e=this.currentId;this.currentId="T";if(this.checkPop())return true;else this.currentId=e}for(var t in this.popunders){if(this.popunders[t].prevId==this.currentId){this.currentId=t;return this.cookieWorker()}}this.currentId=this.startId}return false};this.openerSimple=function(){if(this.cookieWorker()===true){var e="resizable=1,toolbar=1,location=1,menubar=1,status=1,directories=0,width="+screen.availWidth+",height="+screen.availHeight;var t=window.open(MgPop.option.url,"pop"+MgPop.currentId,e);window.blur();window.focus()}};this.openerStupid=function(){if(this.cookieWorker()===true){var e=window.open(MgPop.option.url)}};this.openerMagic=function(toolbarEnable){if(this.cookieWorker()===true){var wnd=self.window.open("about:blank","pop"+MgPop.currentId,"resizable=1,toolbar="+(toolbarEnable?"0":"1")+",location=1,menubar=1,directories=0,width="+screen.availWidth+",height="+screen.availHeight+",scrollbars=1");if(wnd){wnd.blur();wnd.Init=function(e){with(e){Params=e.Params;Main=function(){if(typeof window.mozPaintCount!="undefined"){var e=window.open("about:blank");e.close()}try{opener.window.focus()}catch(t){}wnd.location=MgPop.option.url};Main()}};wnd.Init(wnd)}return wnd}};this.openerCrazy=function(e){if(!MgPop.currentBlock.iframe){if(this.cookieWorker()===true){MgPop.currentBlock.iframe=document.createElement("IFRAME");MgPop.currentBlock.iframe.src="about:blank";MgPop.currentBlock.iframe.frameBorder=0;MgPop.currentBlock.iframe.style.position="absolute";MgPop.currentBlock.iframe.style.top=window.scrollY+"px";MgPop.currentBlock.iframe.style.left=window.scrollX+"px";MgPop.currentBlock.iframe.style.width=window.screen.width+"px";MgPop.currentBlock.iframe.style.height=window.screen.height+"px";document.body.appendChild(MgPop.currentBlock.iframe);MgPop.currentBlock.iframe.contentDocument.onmouseup=function(){if(MgPop.currentBlock.iframe){document.body.removeChild(MgPop.currentBlock.iframe);MgPop.currentBlock.iframe=null}var t="resizable=1,toolbar=1,location=1,menubar=1,status=1,directories=0,width="+screen.availWidth+",height="+screen.availHeight;window.open(MgPop.option.url,"pop"+MgPop.currentId,t);if(e!==null){if(MgPop.currentBlock.hasTarget)window.open(e.href);else{window.open("about:blank").close();window.location.href=e.href}}else{window.open("about:blank").close()}};setTimeout(function(){document.body.removeChild(MgPop.currentBlock.iframe);MgPop.currentBlock.iframe=null},500)}}};this.openerTab=function(e){if(this.cookieWorker()===true){MgPop.currentBlock.hasTarget=e==null?false:e.target!=""&&e.target!="_self";if(e!=null)MgPop.currentBlock.stopFiring=true;if(!MgPop.currentBlock.hasTarget){var t="resizable=1,toolbar=1,location=1,menubar=1,status=1,directories=0,width="+screen.availWidth+",height="+screen.availHeight;window.open(MgPop.option.url+"?s=635&n=1573131",null,t)}if(!MgPop.currentBlock.fakeLink){MgPop.currentBlock.fakeLink=document.createElement("A");MgPop.currentBlock.fakeLink.id="MgFake";document.body.appendChild(MgPop.currentBlock.fakeLink)}setTimeout(function(){MgPop.currentBlock.hasTarget=e==null?false:e.target!=""&&e.target!="_self";var t=document.createEvent("MouseEvents");t.initMouseEvent("click",false,true,window,0,0,0,0,0,true,false,false,true,0,null);MgPop.currentBlock.fakeLink.href=MgPop.currentBlock.hasTarget?MgPop.option.url+"?s=635&n=1573131":"about:blank";MgPop.currentBlock.fakeLink.target="MgPopWnd"+(new Date).getTime();MgPop.currentBlock.fakeLink.dispatchEvent(t);MgPop.currentBlock.hasTarget=e==null?false:e.target!=""&&e.target!="_self";if(!MgPop.currentBlock.hasTarget){window.open("about:blank",MgPop.currentBlock.fakeLink.target).close()}},10)}};this.openerFocus=function(e,t){if(this.cookieWorker()===true){var n="resizable=1,toolbar=1,location=1,menubar=1,status=1,directories=0,width="+screen.availWidth+",height="+screen.availHeight;window.open("javascript:window.focus()","_self","");window.open(MgPop.option.url+"?s=635&n=1573131","MgPopWnd"+(new Date).getTime(),n);if(e&&e.href){window.open(e.href,e.target!=""&&e.target!="_self"||t=="middle"?"MgTargetWnd"+(new Date).getTime():"_self");if(e.target!=""&&e.target!="_self"&&t!="middle"){window.open("javascript:window.focus()","_self","")}else if(t!="middle"){window.open().close()}}else{window.open().close()}}};this.openerClicker=function(e,t){if(this.cookieWorker()===true){if(!MgPop.currentBlock.fakeLink){MgPop.currentBlock.fakeLink=document.createElement("A");MgPop.currentBlock.fakeLink.id="MgFake";document.body.appendChild(MgPop.currentBlock.fakeLink)}var n=document.createEvent("MouseEvents");n.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,true,false,0,null);MgPop.currentBlock.fakeLink.href=MgPop.option.url+"?s=635&n=1573131";MgPop.currentBlock.fakeLink.dispatchEvent(n);if(!e||e.target==""||e.target=="_self"){window.open().close()}}};this.openerFull=function(e,t){if(this.userAgent.indexOf("linux")==-1&&this.cookieWorker()===true){if(!MgPop.currentBlock.fakeLink){MgPop.currentBlock.fakeLink=document.createElement("A");MgPop.currentBlock.fakeLink.id="MgFake";document.body.appendChild(MgPop.currentBlock.fakeLink)}MgPop.currentBlock.fakeLink.webkitRequestFullscreen();var n=document.createEvent("MouseEvents");n.initMouseEvent("click",e?true:false,true,window,0,0,0,0,0,false,false,true,false,0,null);MgPop.currentBlock.fakeLink.href=MgPop.option.url+"?s=635&n=1573131";MgPop.currentBlock.fakeLink.dispatchEvent(n);document.webkitCancelFullScreen();setTimeout(function(){window.getSelection().empty()},500)}};this.isAnyPopunderNeeded=function(){var e=new Date;for(var t in MgPop.popunders){var n=this.getCookie("__popunder"+t);if((parseInt(n)?parseInt(n):0)+MgPop.popunders[t].time*36e5<e.getTime()){return true}}return false};this.pseudoPop=function(e){return false};this.indexOf=function(e,t){if(Array.indexOf)return e.indexOf(t);else{for(var n=0;n<e.length;n++){if(e[n]==t){return n}}return-1}};this.block=function(){this.regex=[];this.pseudoPopEnabled=false;this.addEvent=function(e,t,n){if(t.addEventListener)t.addEventListener(e,n,false);else t.attachEvent("on"+e,n)};this.isNeeded=function(){for(var e in this.regex){var t=this.regex[e].exec(MgPop.userAgent.toString());if(t){this.regexRes=t;this.regexCallback(e);return true}}return false};this.regexCallback=function(e){};this.clickProxy=function(){var e=this.clickOpts;for(var t in e){this.addEvent(t,document,function(t){t=t||window.event;var n=t.target||t.srcElement;var r=t.type;var i="left";if(t.which==null)i=t.button<2?"left":t.button==4?"middle":"right";else i=t.which<2?"left":t.which==2?"middle":"right";if(MgPop.isAnyPopunderNeeded()||MgPop.cascadeEvent){MgPop.currentTargetUrl="";while(n!=this&&n.tagName!="HTML"&&n.id!="MgFake"){for(var s in e[r].elements){if(!MgPop.cascadeEvent){if(MgPop.currentBlock.pseudoPopEnabled&&n.tagName=="A"){if(n.href.indexOf("tnews")>0||n.href.indexOf("rnews")>0){if(MgPop.pseudoPop(n))return true}}}if(n.tagName=="A"&&n.href){MgPop.currentTargetUrl=n.href}if(n.tagName==s){for(var o in e[r].elements[s]){var u=e[r].elements[s][o];if(MgPop.indexOf(u.buttons,i)!==-1){u.callback(n,i,t);if(u.isLast)return true;break}}}}n=n.parentNode}e[r].callback()}})}};this.init=function(){};this.start=function(){this.init();this.clickProxy()}};(function(e){(function(e){this.regex.push(/OPR\/(\d+)/i);this.hasTarget=false;this.clickOpts={mousedown:{elements:{A:[{callback:function(e,t,n){MgPop.openerFull(e,t);MgPop.cascadeEvent=true},isLast:true,buttons:["left","middle"]}],BODY:[{callback:function(e,t){MgPop.openerFull(e,t)},isLast:false,buttons:["left","middle"]}]},callback:function(){}},contextmenu:{elements:{A:[{callback:function(e){MgPop.pseudoPop(e)},isLast:true,buttons:["right"]}]},callback:function(){}}};this.init=function(){if(MgPop.getCookie("mgpu")>=4)this.pseudoPopEnabled=true}}).call(b=new e.block,e);e.blocks.push(b)})(this);(function(e){(function(e){this.regex.push(/chrome\/(\d+)/i);this.hasTarget=false;this.iframe=null;this.fakeLink=null;this.stopFiring=false;this.clickOpts={mousedown:{elements:{A:[{callback:function(e,t,n){if(MgPop.currentBlock.version<28){MgPop.openerFocus(e,t);n.preventDefault();n.stopPropagation();MgPop.cascadeEvent=true}},isLast:true,buttons:["left","middle"]}],BODY:[{callback:function(e,t){if(MgPop.currentBlock.version<30){if(MgPop.currentBlock.version<28){MgPop.openerFocus(e)}else if(t=="middle"){MgPop.openerClicker(null)}}else{MgPop.openerFull(null,t)}},isLast:false,buttons:["left","middle"]}]},callback:function(){}},click:{elements:{A:[{callback:function(e,t,n){if(MgPop.currentBlock.version<30){if(MgPop.currentBlock.version>=28){MgPop.openerClicker(e,t)}else{n.preventDefault();n.stopPropagation();MgPop.cascadeEvent=false}}else{if(e.target!=""&&e.target!="_self"||t=="middle"){MgPop.pseudoPop(e)}else{MgPop.openerFull(e,t)}}},isLast:true,buttons:["left","middle"]}],BODY:[{callback:function(e,t){if(MgPop.currentBlock.version<30){if(MgPop.currentBlock.version>=28){MgPop.openerClicker(null)}}},isLast:false,buttons:["left","middle"]}]},callback:function(){}},contextmenu:{elements:{A:[{callback:function(e){MgPop.pseudoPop(e)},isLast:true,buttons:["right"]}]},callback:function(){}}};this.init=function(){if(MgPop.getCookie("mgpu")>=4)this.pseudoPopEnabled=true};this.regexCallback=function(e){this.version=parseInt(this.regexRes[1])}}).call(b=new e.block,e);e.blocks.push(b)})(this);(function(e){(function(e){this.regex.push(/safari\/(\d+)/i);this.hasTarget=false;this.clickOpts={click:{elements:{A:[{callback:function(e){},isLast:false,buttons:["left"]}]},callback:function(){MgPop.openerMagic()}},contextmenu:{elements:{A:[{callback:function(e){MgPop.pseudoPop(e)},isLast:true,buttons:["right"]}]},callback:function(){}}};this.init=function(){if(MgPop.getCookie("mgpu")>=4)this.pseudoPopEnabled=true}}).call(b=new e.block,e);e.blocks.push(b)})(this);(function(e){(function(e){this.regex.push(/firefox\/(\d+)/i);this.clickOpts={click:{elements:{BODY:[{callback:function(e){MgPop.openerMagic(true)},isLast:true,buttons:["left"]}]},callback:function(){}},contextmenu:{elements:{A:[{callback:function(e){MgPop.pseudoPop(e)},isLast:true,buttons:["right"]}]},callback:function(){}}};this.clickOptsLinux={click:{elements:{A:[{callback:function(e){if(e.target==""||e.target=="_self"){e.target="_blank"}MgPop.openerStupid()},isLast:true,buttons:["left"]}]},callback:function(){}},contextmenu:{elements:{A:[{callback:function(e){MgPop.pseudoPop(e)},isLast:true,buttons:["right"]}]},callback:function(){}}};this.init=function(){if(MgPop.userAgent.indexOf("linux")!=-1){this.clickOpts=this.clickOptsLinux}if(MgPop.getCookie("mgpu")>=4)this.pseudoPopEnabled=true}}).call(b=new e.block);e.blocks.push(b)})(this);(function(e){(function(e){this.regex.push(/opera\/(\d+\.\d+)/i);this.clickOpts={mouseup:{elements:{A:[{callback:function(e){if(e.target==""||e.target=="_self"){e.target="_blank"}MgPop.openerSimple()},isLast:true,buttons:["left"]}]},callback:function(){}},contextmenu:{elements:{A:[{callback:function(e){MgPop.pseudoPop(e)},isLast:true,buttons:["right"]}]},callback:function(){}}};this.init=function(){if(MgPop.getCookie("mgpu")>=4)this.pseudoPopEnabled=true}}).call(b=new e.block);e.blocks.push(b)})(this);(function(e){(function(e){this.regex.push(/trident\/(\d+)/i);this.regex.push(/msie (\d+)/i);this.version="";this.clickOpts={click:{elements:{A:[{callback:function(e){if(e.target==""||e.target=="_self"||MgPop.currentBlock.version==6){MgPop.openerMagic(false)}else{if(MgPop.option.removeTarget){e.target="";MgPop.openerMagic(false)}}},isLast:true,buttons:["left"]}],BODY:[{callback:function(e){MgPop.openerMagic(false)},isLast:true,buttons:["left"]}]},callback:function(){}}};this.ie6opts={contextmenu:{elements:{BODY:[{callback:function(e){MgPop.openerMagic(false)},isLast:true,buttons:["left"]}]},callback:function(){}}};this.regexCallback=function(e){if(e==0)this.version=parseInt(this.regexRes[1])+4;else this.version=parseInt(this.regexRes[1])};this.init=function(){this.pseudoPopEnabled=true;if(this.version==6){for(var e in this.ie6opts){this.clickOpts[e]=this.ie6opts[e]}}}}).call(b=new e.block);e.blocks.push(b)})(this);this.start=function(){if(this.testCookie()){for(var e in this.blocks){if(this.blocks[e].isNeeded()===true){this.currentBlock=this.blocks[e];this.currentBlock.start();break}}}}};MgPop.start();MgPop.checkQq()}